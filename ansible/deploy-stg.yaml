- hosts: thincrust-stg
  tasks:
   
    - name: Create directory
      file:
        path: ./mattermost-webapp/
        state: directory

    - name: mattermost-webapp-stg.tar.gz
      copy:
        src: ../binaries-files/mattermost-webapp-stg.tar.gz
        dest: ./mattermost-webapp/mattermost-webapp-stg.tar.gz
   
    - name: Deploy staging version of mattermost-webapp
      shell: |
        cd ./mattermost-webapp
        mv mattermost-webapp-stg.tar.gzmattermost-webapp.tar.gz
        tar -xvf mattermost-webapp.tar.gz
        sudo rm -rf /opt/gitlab/embedded/service/mattermost/client_leo
        sudo mv /opt/gitlab/embedded/service/mattermost/client /opt/gitlab/embedded/service/mattermost/client_leo
        sudo cp -R client/ /opt/gitlab/embedded/service/mattermost
        rm -rf client/
    #     sudo cp sync.py /opt/mattermost-sync/sync.py
    #     sudo cp mattermost_api.py /opt/mattermost-sync/mattermost_api.py
    #     sudo cp dynamo_integration.py /opt/mattermost-sync/dynamo_integration.py
